#!/bin/bash
#SBATCH -N 1 #Number of nodes
#SBATCH -n 3 # number of cores
#SBATCH --mem 32G # memory pool for all cores
#SBATCH -t 0-23:00 # time (D-HH:MM)
#SBATCH -o samtools_{0}.%N.%j.log
#SBATCH -e samtools_{0}.%N.%j.log
#SBATCH --mail-type=FAIL
#SBATCH --account=rrg-tetreaum
#SBATCH --mail-user={1}

ml samtools
source /lustre09/project/6019267/shared/tools/main_pipelines/long-read/launch_pipeline_env/bin/activate
STEPS_DONE="{2}/scripts/steps_done.txt"

python -u \
    /lustre09/project/6019267/shared/tools/main_pipelines/long-read/LongReadSequencingONT/samtools_per_sample.py \
    --config {3} \
    --sample {4}

if [ $? -eq 0 ]; then
    echo "samtools_{0}" >> "$STEPS_DONE"
fi